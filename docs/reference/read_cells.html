<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Read Cells from file — read_cells • tidycells</title>

<!-- favicons -->
<link rel="icon" type="image/png" sizes="16x16" href="../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../apple-touch-icon.png" />
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../apple-touch-icon-120x120.png" />
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../apple-touch-icon-76x76.png" />
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../apple-touch-icon-60x60.png" />
<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous" />
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script>

<!-- sticky kit -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



<meta property="og:title" content="Read Cells from file — read_cells" />

<meta property="og:description" content="This function is designed to read cell level information
(and the finally analyze, compose and collate_columns)
from many file types like xls, pdf, doc etc.
This is a wrapper function to functions from multiple packages. The support for specific file is dependent on
the installed packages. To see the list of supported files and potentially required packages (if any) just
run read_cells() in the console. This function supports the file format based on content and not based on just the file
extension. That means if a file is saved as pdf and then extension is removed (or extension modified to say .xlsx)
then also the read_cells will detect it as pdf and read its content." />

<meta property="og:image" content="/logo.png" />
<meta name="twitter:card" content="summary" />



<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


  </head>

  <body>
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">tidycells</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.9.2</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/tidycells-intro.html">Tidycells Package</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/r-rudra/tidycells">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      
      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Read Cells from file</h1>
    <small class="dont-index">Source: <a href='https://github.com/r-rudra/tidycells/blob/master/R/read_cells.R'><code>R/read_cells.R</code></a></small>
    <div class="hidden name"><code>read_cells.Rd</code></div>
    </div>

    <div class="ref-description">
    
    <p>This function is designed to read cell level information
(and the finally <a href='analyze_cells.html'>analyze</a>, <a href='compose_cells.html'>compose</a> and <a href='collate_columns.html'>collate_columns</a>)
from many file types like xls, pdf, doc etc.
This is a wrapper function to functions from multiple packages. The support for specific file is dependent on
the installed packages. To see the list of supported files and potentially required packages (if any) just
run <code>read_cells()</code> in the console. This function supports the file format based on content and not based on just the file
extension. That means if a file is saved as pdf and then extension is removed (or extension modified to say <code>.xlsx</code>)
then also the <code>read_cells</code> will detect it as pdf and read its content.</p>
    
    </div>

    <pre class="usage"><span class='fu'>read_cells</span>(<span class='no'>x</span>, <span class='kw'>at_level</span> <span class='kw'>=</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/c'>c</a></span>(<span class='st'>"collate"</span>, <span class='st'>"detect_and_read"</span>, <span class='st'>"make_cells"</span>,
  <span class='st'>"va_classify"</span>, <span class='st'>"analyze"</span>, <span class='st'>"compose"</span>), <span class='kw'>omit</span> <span class='kw'>=</span> <span class='kw'>NULL</span>, <span class='kw'>simplify</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>,
  <span class='kw'>compose_main_cols_only</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>from_level</span>, <span class='kw'>silent</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>, <span class='no'>...</span>)</pre>
    
    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>either a valid file path or a <code><a href='read_cell_part-class.html'>read_cell_part</a></code></p></td>
    </tr>
    <tr>
      <th>at_level</th>
      <td><p>till which level to process.
Should be one of <code>detect_and_read</code>, <code>make_cells</code>, <code>va_classify</code>, <code>analyze</code>, <code>compose</code>, <code>collate</code>.
Or simply a number (like 1 means <code>detect_and_read</code>, 5 means <code>compose</code>).</p></td>
    </tr>
    <tr>
      <th>omit</th>
      <td><p>(Optional) the file-types to omit. A character vector.</p></td>
    </tr>
    <tr>
      <th>simplify</th>
      <td><p>whether to simplify the output. (Default <code>TRUE</code>). If set to <code>FALSE</code> a <code><a href='read_cell_part-class.html'>read_cell_part</a></code>
will be returned.</p></td>
    </tr>
    <tr>
      <th>compose_main_cols_only</th>
      <td><p>whether to compose main columns only. (Default <code>TRUE</code>).</p></td>
    </tr>
    <tr>
      <th>from_level</th>
      <td><p>(Optional) override start level. (<code>read_cells</code> will process after <code>from_level</code>)</p></td>
    </tr>
    <tr>
      <th>silent</th>
      <td><p>if <code>TRUE</code> no message will be displayed.(Default <code>TRUE</code>)</p></td>
    </tr>
    <tr>
      <th>...</th>
      <td><p>further arguments</p></td>
    </tr>
    </table>
    
    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>If <code>simplify=TRUE</code> then different kind of object is returned in different levels (depends on <code>at_level</code>).
If <code>at_level="compose"</code> then only final tibble is returned otherwise if the output is not <code>NULL</code> an attribute will be present
named <code>"read_cells_stage"</code>.</p>
<p>If <code>simplify=FALSE</code> then it will return a <code><a href='read_cell_part-class.html'>read_cell_part</a></code> which you can process manually
and continue again with <code>read_cells</code> (perhaps then <code>from_level</code> may be useful).</p>
    
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>It performs following set of actions if called with default <code>at_level</code>.</p><ul>
<li><p><strong>detect_and_read</strong>: Detect file type based on content and attempt to read the same in a format suitable to convert as <code><a href='cell_df-class.html'>cell_df</a></code>.</p></li>
<li><p><strong>make_cells</strong>: Convert the file content to <code><a href='cell_df-class.html'>cell_df</a></code> using <code><a href='as_cell_df.html'>as_cell_df</a></code>.</p></li>
<li><p><strong>va_classify</strong>: Run <a href='value_attribute_classify.html'>Value Attribute Classification</a> using <code><a href='numeric_values_classifier.html'>numeric_values_classifier</a></code>.</p></li>
<li><p><strong>analyze</strong>: Analyze the cells using <code><a href='analyze_cells.html'>analyze_cells</a></code>.</p></li>
<li><p><strong>compose</strong>: Compose the cell-analysis to a tidy form using <code><a href='compose_cells.html'>compose_cells</a></code>.</p></li>
<li><p><strong>collate</strong>: Finally collate columns based on content using <code><a href='collate_columns.html'>collate_columns</a></code>.</p></li>
</ul>
    <p>Here is the flowchart of the same:
    <img src='figures/read_cells.svg' width=400 /></p>
    

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='co'># see supported files</span>
<span class='fu'>read_cells</span>()</div><div class='output co'>#&gt; <span style='color: #0000BB;'>Please provide a valid file path to process.
#&gt; Support present for following type of files: </span><span style='color: #0000BB;font-weight: bold;'>csv, xls, xlsx, docx, pdf, html</span><span>
#&gt; Note:
#&gt; = </span><span style='color: #0000BB;'>LibreOffice may be required for doc files</span><span>
#&gt; = </span><span style='color: #0000BB;'>Support is enabled for content type (means it will work even if the extension is wrong)</span><span>
#&gt; = </span><span style='color: #0000BB;'>Support</span><span style='color: #0000BB;font-weight: bold;'> not </span><span style='color: #0000BB;'>present for following type of files: </span><span style='color: #BB0000;font-weight: bold;'>doc</span><span>
#&gt; Details: 
#&gt; </span><span style='color: #00BBBB;'>+----------------------------------------------+</span><span>
#&gt; </span><span style='color: #00BBBB;'>|</span><span>                                              </span><span style='color: #00BBBB;'>|</span><span>
#&gt; </span><span style='color: #00BBBB;'>|</span><span>   </span><span style='color: #0000BB;'>  type        package    present support</span><span>   </span><span style='color: #00BBBB;'>|</span><span>
#&gt; </span><span style='color: #00BBBB;'>|</span><span>   </span><span style='color: #555555;'>1</span><span style='color: #00BBBB;'> csv{utils}  utils        </span><span style='color: #00BB00;'>v</span><span style='color: #00BBBB;'>      </span><span style='color: #00BB00;'>v</span><span style='color: #00BBBB;'>   </span><span>     </span><span style='color: #00BBBB;'>|</span><span>
#&gt; </span><span style='color: #00BBBB;'>|</span><span>   </span><span style='color: #555555;'>2</span><span style='color: #00BBBB;'> csv         readr        </span><span style='color: #00BB00;'>v</span><span style='color: #00BBBB;'>      </span><span style='color: #00BB00;'>v</span><span style='color: #00BBBB;'>   </span><span>     </span><span style='color: #00BBBB;'>|</span><span>
#&gt; </span><span style='color: #00BBBB;'>|</span><span>   </span><span style='color: #555555;'>3</span><span style='color: #00BBBB;'> xls{readxl} readxl       </span><span style='color: #00BB00;'>v</span><span style='color: #00BBBB;'>      </span><span style='color: #00BB00;'>v</span><span style='color: #00BBBB;'>   </span><span>     </span><span style='color: #00BBBB;'>|</span><span>
#&gt; </span><span style='color: #00BBBB;'>|</span><span>   </span><span style='color: #555555;'>4</span><span style='color: #00BBBB;'> xls         xlsx         </span><span style='color: #00BB00;'>v</span><span style='color: #00BBBB;'>      </span><span style='color: #00BB00;'>v</span><span style='color: #00BBBB;'>   </span><span>     </span><span style='color: #00BBBB;'>|</span><span>
#&gt; </span><span style='color: #00BBBB;'>|</span><span>   </span><span style='color: #555555;'>5</span><span style='color: #00BBBB;'> xlsx        tidyxl       </span><span style='color: #00BB00;'>v</span><span style='color: #00BBBB;'>      </span><span style='color: #00BB00;'>v</span><span style='color: #00BBBB;'>   </span><span>     </span><span style='color: #00BBBB;'>|</span><span>
#&gt; </span><span style='color: #00BBBB;'>|</span><span>   </span><span style='color: #555555;'>6</span><span style='color: #00BBBB;'> doc         docxtractr   </span><span style='color: #00BB00;'>v</span><span style='color: #00BBBB;'>      </span><span style='color: #BB0000;'>x</span><span style='color: #00BBBB;'>  </span><span>      </span><span style='color: #00BBBB;'>|</span><span>
#&gt; </span><span style='color: #00BBBB;'>|</span><span>   </span><span style='color: #555555;'>7</span><span style='color: #00BBBB;'> docx        docxtractr   </span><span style='color: #00BB00;'>v</span><span style='color: #00BBBB;'>      </span><span style='color: #00BB00;'>v</span><span style='color: #00BBBB;'>   </span><span>     </span><span style='color: #00BBBB;'>|</span><span>
#&gt; </span><span style='color: #00BBBB;'>|</span><span>   </span><span style='color: #555555;'>8</span><span style='color: #00BBBB;'> pdf         tabulizer    </span><span style='color: #00BB00;'>v</span><span style='color: #00BBBB;'>      </span><span style='color: #00BB00;'>v</span><span style='color: #00BBBB;'>   </span><span>     </span><span style='color: #00BBBB;'>|</span><span>
#&gt; </span><span style='color: #00BBBB;'>|</span><span>   </span><span style='color: #555555;'>9</span><span style='color: #00BBBB;'> html        XML          </span><span style='color: #00BB00;'>v</span><span style='color: #00BBBB;'>      </span><span style='color: #00BB00;'>v</span><span style='color: #00BBBB;'>   </span><span>     </span><span style='color: #00BBBB;'>|</span><span>
#&gt; </span><span style='color: #00BBBB;'>|</span><span>                                              </span><span style='color: #00BBBB;'>|</span><span>
#&gt; </span><span style='color: #00BBBB;'>+----------------------------------------------+</span><span></div><div class='input'>
<span class='no'>fold</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/system.file'>system.file</a></span>(<span class='st'>"extdata"</span>, <span class='st'>"messy"</span>, <span class='kw'>package</span> <span class='kw'>=</span> <span class='st'>"tidycells"</span>, <span class='kw'>mustWork</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)
<span class='co'># File extension is intentionally given wrong</span>
<span class='co'># while filename is actual identifier of the file type</span>
<span class='no'>fcsv</span> <span class='kw'>&lt;-</span> <span class='fu'><a href='https://www.rdocumentation.org/packages/base/topics/list.files'>list.files</a></span>(<span class='no'>fold</span>, <span class='kw'>pattern</span> <span class='kw'>=</span> <span class='st'>"^csv."</span>, <span class='kw'>full.names</span> <span class='kw'>=</span> <span class='fl'>TRUE</span>)[<span class='fl'>1</span>]
<span class='co'># read the data</span>
<span class='fu'>read_cells</span>(<span class='no'>fcsv</span>)</div><div class='output co'>#&gt; </span><span style='color: #555555;'># A tibble: 4 x 5</span><span>
#&gt;   collated_1 collated_2 collated_3 table_tag value
#&gt;   </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>      </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>      </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>      </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>     </span><span style='color: #555555;font-style: italic;'>&lt;chr&gt;</span><span>
#&gt; </span><span style='color: #555555;'>1</span><span> Nakshatra  Weight     Kid Name   Table_1   12   
#&gt; </span><span style='color: #555555;'>2</span><span> Titas      Weight     Kid Name   Table_1   16   
#&gt; </span><span style='color: #555555;'>3</span><span> Nakshatra  Age        Kid Name   Table_1   1.5  
#&gt; </span><span style='color: #555555;'>4</span><span> Titas      Age        Kid Name   Table_1   6    </div></span></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
    <h2>Contents</h2>
    <ul class="nav nav-pills nav-stacked">
      <li><a href="#arguments">Arguments</a></li>
      
      <li><a href="#value">Value</a></li>

      <li><a href="#details">Details</a></li>
      
      <li><a href="#examples">Examples</a></li>
    </ul>

  </div>
</div>

      <footer>
      <div class="copyright">
  <p>Developed by Indranil Gayen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
   </div>

  

  </body>
</html>

